{"version":3,"file":"VSelect.mjs","names":["VDialogTransition","VChip","VDefaultsProvider","VList","VListItem","VMenu","VTextField","makeItemsProps","useItems","makeTransitionProps","useForwardRef","useLocale","useProxiedModel","IconValue","computed","ref","genericComponent","propsFactory","useRender","wrapInArray","makeSelectProps","chips","Boolean","closableChips","eager","hideNoData","hideSelected","menuIcon","type","default","modelValue","multiple","noDataText","String","openOnClear","itemChildren","VSelect","name","props","transition","component","emits","val","setup","slots","t","vTextFieldRef","menu","items","transformIn","transformOut","model","v","transformed","selections","value","map","find","item","selected","selection","onClear","e","onClickControl","length","onKeydown","includes","key","select","index","findIndex","splice","hasChips","chip","join","preventDefault","onChipClose","stopPropagation","slotProps","closable","size","text","title","originalItem"],"sources":["../../../src/components/VSelect/VSelect.tsx"],"sourcesContent":["// Styles\nimport './VSelect.sass'\n\n// Components\nimport { VDialogTransition } from '@/components/transitions'\nimport { VChip } from '@/components/VChip'\nimport { VDefaultsProvider } from '@/components/VDefaultsProvider'\nimport { VList, VListItem } from '@/components/VList'\nimport { VMenu } from '@/components/VMenu'\nimport { VTextField } from '@/components/VTextField'\n\n// Composables\nimport { makeItemsProps, useItems } from '@/composables/items'\nimport { makeTransitionProps } from '@/composables/transition'\nimport { useForwardRef } from '@/composables/forwardRef'\nimport { useLocale } from '@/composables/locale'\nimport { useProxiedModel } from '@/composables/proxiedModel'\nimport { IconValue } from '@/composables/icons'\n\n// Utility\nimport { computed, ref } from 'vue'\nimport { genericComponent, propsFactory, useRender, wrapInArray } from '@/util'\n\n// Types\nimport type { VInputSlots } from '@/components/VInput/VInput'\nimport type { VFieldSlots } from '@/components/VField/VField'\nimport type { InternalItem } from '@/composables/items'\nimport type { MakeSlots } from '@/util'\n\nexport const makeSelectProps = propsFactory({\n  chips: Boolean,\n  closableChips: Boolean,\n  eager: Boolean,\n  hideNoData: Boolean,\n  hideSelected: Boolean,\n  menuIcon: {\n    type: IconValue,\n    default: '$dropdown',\n  },\n  modelValue: {\n    type: null,\n    default: () => ([]),\n  },\n  multiple: Boolean,\n  noDataText: {\n    type: String,\n    default: '$vuetify.noDataText',\n  },\n  openOnClear: Boolean,\n\n  ...makeItemsProps({ itemChildren: false }),\n}, 'select')\n\ntype Primitive = string | number | boolean | symbol\n\ntype Val <T, ReturnObject extends boolean> = T extends Primitive\n  ? T\n  : (ReturnObject extends true ? T : any)\n\ntype Value <T, ReturnObject extends boolean, Multiple extends boolean> =\n  Multiple extends true\n    ? Val<T, ReturnObject>[]\n    : Val<T, ReturnObject>\n\nexport const VSelect = genericComponent<new <\n  T,\n  ReturnObject extends boolean = false,\n  Multiple extends boolean = false,\n  V extends Value<T, ReturnObject, Multiple> = Value<T, ReturnObject, Multiple>\n>() => {\n  $props: {\n    items?: readonly T[]\n    returnObject?: ReturnObject\n    multiple?: Multiple\n    modelValue?: Readonly<V>\n    'onUpdate:modelValue'?: (val: V) => void\n  }\n  $slots: VInputSlots & VFieldSlots & MakeSlots<{\n    chip: [{ item: T, index: number, props: Record<string, unknown> }]\n    selection: [{ item: T, index: number }]\n    'no-data': []\n  }>\n}>()({\n  name: 'VSelect',\n\n  props: {\n    ...makeSelectProps(),\n    ...makeTransitionProps({ transition: { component: VDialogTransition } }),\n  },\n\n  emits: {\n    'update:modelValue': (val: any) => true,\n  },\n\n  setup (props, { slots }) {\n    const { t } = useLocale()\n    const vTextFieldRef = ref()\n    const menu = ref(false)\n    const { items, transformIn, transformOut } = useItems(props)\n    const model = useProxiedModel(\n      props,\n      'modelValue',\n      [],\n      v => transformIn(wrapInArray(v)),\n      v => {\n        const transformed = transformOut(v)\n        return props.multiple ? transformed : transformed[0]\n      }\n    )\n    const selections = computed(() => {\n      return model.value.map(v => {\n        return items.value.find(item => item.value === v.value) || v\n      })\n    })\n    const selected = computed(() => selections.value.map(selection => selection.props.value))\n\n    function onClear (e: MouseEvent) {\n      model.value = []\n\n      if (props.openOnClear) {\n        menu.value = true\n      }\n    }\n    function onClickControl () {\n      if (props.hideNoData && !items.value.length) return\n\n      menu.value = true\n    }\n    function onKeydown (e: KeyboardEvent) {\n      if (['Enter', 'ArrowDown', ' '].includes(e.key)) {\n        menu.value = true\n      }\n\n      if (['Escape', 'Tab'].includes(e.key)) {\n        menu.value = false\n      }\n    }\n    function select (item: InternalItem) {\n      if (props.multiple) {\n        const index = selected.value.findIndex(selection => selection === item.value)\n\n        if (index === -1) {\n          model.value = [...model.value, item]\n        } else {\n          const value = [...model.value]\n          value.splice(index, 1)\n          model.value = value\n        }\n      } else {\n        model.value = [item]\n        menu.value = false\n      }\n    }\n\n    useRender(() => {\n      const hasChips = !!(props.chips || slots.chip)\n\n      return (\n        <VTextField\n          ref={ vTextFieldRef }\n          class={[\n            'v-select',\n            {\n              'v-select--active-menu': menu.value,\n              'v-select--chips': !!props.chips,\n              [`v-select--${props.multiple ? 'multiple' : 'single'}`]: true,\n            },\n          ]}\n          appendInnerIcon={ props.menuIcon }\n          readonly\n          onClick:clear={ onClear }\n          onClick:input={ onClickControl }\n          onClick:control={ onClickControl }\n          onBlur={ () => menu.value = false }\n          modelValue={ model.value.map(v => v.props.value).join(', ') }\n          onKeydown={ onKeydown }\n        >\n          {{\n            ...slots,\n            default: () => (\n              <>\n                <VMenu\n                  v-model={ menu.value }\n                  activator=\"parent\"\n                  contentClass=\"v-select__content\"\n                  eager={ props.eager }\n                  openOnClick={ false }\n                  transition={ props.transition }\n                >\n                  <VList\n                    selected={ selected.value }\n                    selectStrategy={ props.multiple ? 'independent' : 'single-independent' }\n                  >\n                    { !items.value.length && !props.hideNoData && (slots['no-data']?.() ?? (\n                      <VListItem title={ t(props.noDataText) } />\n                    )) }\n\n                    { items.value.map(item => (\n                      <VListItem\n                        { ...item.props }\n                        onMousedown={ (e: MouseEvent) => e.preventDefault() }\n                        onClick={ () => select(item) }\n                      />\n                    )) }\n                  </VList>\n                </VMenu>\n\n                { selections.value.map((selection, index) => {\n                  function onChipClose (e: Event) {\n                    e.stopPropagation()\n                    e.preventDefault()\n\n                    select(selection)\n                  }\n\n                  const slotProps = {\n                    'onClick:close': onChipClose,\n                    modelValue: true,\n                  }\n\n                  return (\n                    <div class=\"v-select__selection\">\n                      { hasChips ? (\n                        <VDefaultsProvider\n                          defaults={{\n                            VChip: {\n                              closable: props.closableChips,\n                              size: 'small',\n                              text: selection.props.title,\n                            },\n                          }}\n                        >\n                          { slots.chip\n                            ? slots.chip({ props: slotProps, selection, index })\n                            : (<VChip { ...slotProps } />)\n                          }\n                        </VDefaultsProvider>\n                      ) : (\n                        slots.selection\n                          ? slots.selection({ item: selection.originalItem, index })\n                          : (\n                            <span class=\"v-select__selection-text\">\n                              { selection.props.title }\n                              { props.multiple && (index < selections.value.length - 1) && (\n                                <span class=\"v-select__selection-comma\">,</span>\n                              ) }\n                            </span>\n                          )\n                      )}\n                    </div>\n                  )\n                }) }\n              </>\n            ),\n          }}\n        </VTextField>\n      )\n    })\n\n    return useForwardRef({}, vTextFieldRef)\n  },\n})\n\nexport type VSelect = InstanceType<typeof VSelect>\n"],"mappings":"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"}